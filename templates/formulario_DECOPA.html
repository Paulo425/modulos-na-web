{% extends 'base.html' %}

{% block conteudo %}
<div class="container mt-5">
    <h2 class="text-center text-primary mb-4">Gerar Memorial Descritivo</h2>

    <form method="POST" enctype="multipart/form-data">
        <div class="mb-3">
            <label for="diretorio" class="form-label">Cidade:</label>
            <input type="text" class="form-control" name="cidade" id="cidade" required>
        </div>

        <div class="mb-3">
            <label for="excel" class="form-label">Arquivo Excel:</label>
            <input type="file" class="form-control" name="excel" id="excel" accept=".xlsx" required>
        </div>

        <div class="mb-3">
            <label for="dxf" class="form-label">Arquivo DXF:</label>
            <input type="file" class="form-control" name="dxf" id="dxf" accept=".dxf" required>
        </div>

        <div class="d-grid mt-4">
            <button type="submit" class="btn btn-primary btn-lg">Executar</button>
        </div>
    </form>

<hr>
<div style="margin-top: 20px;">
    <h3>ğŸ“ Acessar arquivos gerados</h3>
    <a href="{{ url_for('listar_arquivos') }}" target="_blank" style="padding: 10px 20px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">
        ğŸ“¥ Ver arquivos disponÃ­veis para download
    </a>
</div>


    {% if resultado %}
    <div class="alert alert-success mt-4 text-center">
        {{ resultado | safe }}
    </div>
    {% endif %}

    {% if erro %}
    <div class="alert alert-danger mt-4">
        {{ erro | safe }}
    </div>
    {% endif %}

    {% if zip_download %}
    <div class="mt-4 text-center">
        <a href="{{ url_for('download_zip', filename=zip_download) }}" class="btn btn-success btn-lg">
            ğŸ“¦ Baixar ZIP Gerado
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% if log_path %}
    <div class="mt-3 text-center">
        <a href="{{ url_for('static', filename=log_path) }}" class="btn btn-secondary" target="_blank">
            ğŸ“œ Ver Log da ExecuÃ§Ã£o
        </a>
    </div>
{% endif %}

