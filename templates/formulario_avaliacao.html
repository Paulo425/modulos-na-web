{% extends 'base.html' %}

{% block conteudo %}
<div class="container mt-5">
    <h2 class="text-primary mb-4 text-center">Formul치rio de Avalia칞칚o PHOENIX APPRAISAL</h2>

    <form method="POST" enctype="multipart/form-data">

        <div class="mb-3">
            <label class="form-label">Planilha de Amostras (Excel):</label>
            <input type="file" name="planilha_excel" accept=".xlsx" class="form-control" required>
        </div>

        <div class="mb-3">
            <label>Nome do Propriet치rio:</label>
            <input type="text" name="nome_proprietario" class="form-control" required>
        </div>

        <div class="mb-3">
            <label>Outros Propriet치rios?</label>
            <select name="outros_proprietarios" class="form-select">
                <option value="nao">N칚o</option>
                <option value="sim">Sim</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Incluir telefone?</label>
            <select name="incluir_tel" class="form-select">
                <option value="nao">N칚o</option>
                <option value="sim">Sim</option>
            </select>
            <input type="text" name="telefone_proprietario" class="form-control mt-2" placeholder="(00) 00000-0000">
        </div>

        <div class="mb-3">
            <label>Incluir e-mail?</label>
            <select name="incluir_mail" class="form-select">
                <option value="nao">N칚o</option>
                <option value="sim">Sim</option>
            </select>
            <input type="email" name="email_proprietario" class="form-control mt-2" placeholder="email@exemplo.com">
        </div>

        <div class="mb-3">
            <label>Solicitante do laudo:</label>
            <input type="text" name="nome_solicitante" class="form-control">
        </div>

        <div class="mb-3">
            <label>Nome do Avaliador:</label>
            <input type="text" name="nome_avaliador" class="form-control">
        </div>

        <div class="mb-3">
            <label>Registro do Avaliador:</label>
            <input type="text" name="registro_avaliador" class="form-control">
        </div>

        <div class="mb-3">
            <label>Tipo de Im칩vel:</label>
            <select name="tipo_imovel_escolhido" class="form-select">
                <option value="">Selecione</option>
                <option>Apartamento residencial</option>
                <option>Casa residencial</option>
                <option>Terreno urbano</option>
                <option>Gleba urbana</option>
                <option>Terreno rural</option>
                <option>Gleba rural</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Finalidade do Laudo:</label>
            <select name="finalidade_lido" class="form-select" onchange="document.getElementById('outraFinalidade').style.display = this.value === 'Outra' ? 'block' : 'none';">
                <option value="">Selecione</option>
                <option>Desapropria칞칚o</option>
                <option>Servid칚o administrativa</option>
                <option>Garantia banc치ria</option>
                <option>Mercado</option>
                <option>Regulariza칞칚o</option>
                <option>Outra</option>
            </select>
            <input id="outraFinalidade" type="text" name="finalidade_descricao" class="form-control mt-2" placeholder="Descreva a finalidade" style="display:none;">
        </div>

        <div class="mb-3">
            <label>츼rea total ou afetada (m):</label>
            <input type="text" name="area_parcial" class="form-control" placeholder="Ex: 2.500,00">
        </div>

        <hr>
        <h5 class="text-secondary">Fatores de Homogeneiza칞칚o</h5>

        {% for fator in [
            'usar_fator_area', 'usar_fator_oferta', 'usar_fator_aproveitamento',
            'localizacao_mesma_regiao', 'usar_fator_topografia', 'usar_fator_pedologia',
            'usar_fator_pavimentacao', 'usar_fator_esquina', 'usar_fator_acessibilidade'
        ] %}
        <div class="mb-3">
            <label>{{ fator.replace('_', ' ').capitalize() }}?</label>
            <select name="{{ fator }}" class="form-select">
                <option value="">Selecione</option>
                <option value="sim">Sim</option>
                <option value="nao">N칚o</option>
            </select>
        </div>
        {% endfor %}

        <hr>
        <h5 class="text-secondary">Documenta칞칚o e Diagn칩stico</h5>

        <div class="mb-3">
            <label>N칰mero da Matr칤cula:</label>
            <input type="text" name="num_doc" class="form-control">
        </div>

        <div class="mb-3">
            <label>Nome do Cart칩rio:</label>
            <input type="text" name="nome_cartorio" class="form-control">
        </div>

        <div class="mb-3">
            <label>Nome da Comarca:</label>
            <input type="text" name="nome_comarca" class="form-control">
        </div>

        <div class="mb-3">
            <label>Endere칞o do Im칩vel:</label>
            <input type="text" name="endereco_imovel" class="form-control">
        </div>

        <div class="mb-3">
            <label>Diagn칩stico - Estrutura:</label>
            <select name="estrutura_escolha" class="form-select">
                <option value="">Selecione</option>
                <option value="BOA">BOA</option>
                <option value="LIMITADA">LIMITADA</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Diagn칩stico - Conduta:</label>
            <select name="conduta_escolha" class="form-select">
                <option value="">Selecione</option>
                <option value="DESESTAGNADO">DESESTAGNADO</option>
                <option value="ESTAGNADA">ESTAGNADA</option>
            </select>
        </div>

        <div class="mb-3">
            <label>Diagn칩stico - Desempenho:</label>
            <select name="desempenho_escolha" class="form-select">
                <option value="">Selecione</option>
                <option value="ALTO">ALTO</option>
                <option value="M칄DIO">M칄DIO</option>
                <option value="BAIXO">BAIXO</option>
            </select>
        </div>

        <hr>
        <h5 class="text-secondary">Arquivos Complementares</h5>

        <div class="mb-3">
            <label>Logo:</label>
            <input type="file" name="arquivo_logo" class="form-control">
        </div>

        <div class="mb-3">
            <label>Fotos do im칩vel:</label>
            <input type="file" name="fotos_imovel" class="form-control" multiple>
        </div>

        <div class="mb-3">
            <label>Documenta칞칚o adicional:</label>
            <input type="file" name="fotos_imovel_adicionais" class="form-control" multiple>
        </div>

        <div class="mb-3">
            <label>Documentos do(s) propriet치rio(s):</label>
            <input type="file" name="doc_proprietario" class="form-control" multiple>
        </div>

        <div class="mb-3">
            <label>Plantas / memoriais descritivos:</label>
            <input type="file" name="doc_planta" class="form-control" multiple>
        </div>

        <div class="text-center mt-4">
            <button type="submit" class="btn btn-primary btn-lg">Gerar Laudo</button>
        </div>
        
    </form>
    {% if resultado %}
    <div class="alert alert-success mt-4 text-center">
        {{ resultado }}
    </div>
    {% endif %}

    {% if zip_download %}
    <div class="alert alert-success mt-4 text-center">
        游닍 <strong>Download dispon칤vel:</strong><br>
        <a class="btn btn-success mt-2" href="{{ url_for('static', filename='arquivos/' ~ zip_download) }}" download>
            Baixar Relat칩rio ZIP
        </a>
    </div>
    {% endif %}

    {% if erro %}
    <div class="alert alert-danger mt-4 text-center">
        {{ erro }}
    </div>
    {% endif %}
</div>
{% endblock %}
